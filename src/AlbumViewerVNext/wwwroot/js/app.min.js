!function(){"use strict";var t=angular.module("app",["ngAnimate","ngRoute","ngSanitize"]);t.config(["$routeProvider",function(t){t.when("/albums",{templateUrl:"app/views/albums.html"}).when("/album/edit/:albumId",{templateUrl:"app/views/editalbum.html"}).when("/album/:albumId",{templateUrl:"app/views/album.html"}).when("/artists",{templateUrl:"app/views/artists.html"}).when("/artist/:artistId",{templateUrl:"app/views/artist.html"}).when("/about",{templateUrl:"app/views/about.html"}).otherwise({redirectTo:"/albums"})}]).filter("linebreakFilter",function(){return function(t){return void 0!==t?t.replace(/\n/g,"<br />"):t}})}(),function(){"use strict";function t(t,e,n,a){function r(t){var t=t.toLowerCase();u.searchVisible="albums"==t||"artists"==t?!0:!1}var u=t;u.searchText="",u.searchVisible=!0,u.activeTab=a.activeTab,u.onKey=function(){t.$emit("onsearchkey",u.searchText)},t.searchBlur=function(){u.searchText=""},u.$on("$locationChangeSuccess",function(){var t=n.location.hash;u.activeTab=t.extract("#/","/",!0),r(u.activeTab)}),r(u.activeTab)}function e(t,e){console.log("artists controller");var n=this;n.artists=[],n.searchText="",n.getArtists=function(){return e.get("../api/artists").success(function(t){n.artists=t})},t.$root.$on("onsearchkey",function(t,e){n.searchText=e}),n.getArtists()}angular.module("app").controller("headerController",t).controller("artistsController",e),t.$inject=["$scope","$route","$window","albumService"],e.$inject=["$scope","$http"]}(),function(){"use strict";function t(t,e,n,a){var r=this;r.album=null,r.error={message:null,icon:"warning",reset:function(){r.error={message:"",icon:"warning"}}},r.isSongVisible=!1,r.song={Id:0,AlbumId:0,Name:null,Length:null},r.saveAlbum=function(t){console.log(t),a.saveAlbum(t).success(function(t){r.error.message="Album saved",r.error.icon="info",setTimeout(function(){e.location.hash="/album/"+t.Id},1e3)}).error(function(){r.error.message="Album saved",r.error.icon="warning"})},r.addSong=function(){r.isSongVisible=!0,r.song={Id:0,AlbumId:a.album.Id,Name:null,Length:null},setTimeout(function(){$("#SongName").focus()},300)},r.saveSong=function(t){a.addSongToAlbum(r.album,t),r.albums=a.albums,r.album=a.album,r.isSongVisible=!1},r.cancelSong=function(){r.isSongVisible=!1},r.removeSong=function(t){console.log(t),a.removeSong(r.album,t),r.album=a.album},r.deleteAlbum=function(t){confirm("Are you sure you want to delete this album?")&&a.deleteAlbum(t).success(function(){r.albums=a.albums,$location.path("#/albums")}).error(onPageError)},r.getAlbum=function(t){a.getAlbum(t,!0).success(function(t){r.album=t})},r.getAlbum(1*t.albumId,!0),n.addClass("#MainView","slide-animation")}angular.module("app").controller("albumController",t),t.$inject=["$routeParams","$window","$animate","albumService"]}(),function(){"use strict";function t(t,e){function n(){return{Id:0,ArtistId:0,Tracks:[],Artist:{Id:0,ArtistName:null},Title:null,AmazonUrl:null,ImageUrl:null}}function a(){return{Id:0,SongName:null,Length:null}}function r(n){return!n&&b.albums&&b.albums.length>0?ww.angular.$httpPromiseFromValue(e,b.albums):t.get("../api/albums/").success(function(t){b.albums=t}).error(onPageError)}function u(n,a){if(0===n||"0"===n)return b.album=b.newAlbum(),ww.angular.$httpPromiseFromValue(e,b.album);if(-1===n||"-1"===n||!n)return ww.angular.$httpPromiseFromValue(e,b.album);if(b.album&&a&&b.album.pk==n){var r=ww.angular.deferredExtender(e.defer());return r.resolve(b.album),r.promise}return t.get("../api/album/"+n).success(function(t){b.album=t}).error(function(t,e,n,a){console.log(t,a)})}function l(t,e){t.Tracks.push(e),b.album=t}function o(t,e){var n=m(t);if(-1!=n){var a=b.albums[n];a.Tracks=_.remove(a.Tracks,function(t){return t.Id!=e.Id}),b.album=a}}function i(t){var e=m(t);e>-1?b.albums[e]=t:(b.albums.push(t),b.albums=_.remove(b.albums,function(){return 0==t.Id})),b.album=t}function s(e){return t.post("../api/album",e).success(function(t){b.updateAlbum(t),b.album=t})}function c(e){return t.get("../api/deletealbum/"+e.Id).success(function(){b.albums=_.remove(b.albums,function(t){return e.Id!=t.Id})})}function m(t){return _.findIndex(b.albums,function(e){return t.Id==e.Id})}var b={albums:[],artists:[],album:n(),getAlbums:r,getAlbum:u,updateAlbum:i,saveAlbum:s,deleteAlbum:c,addSongToAlbum:l,removeSong:o,newAlbum:n,newSong:a,activeTab:"albums"};return b}angular.module("app").factory("albumService",t),t.$inject=["$http","$q"]}(),function(){"use strict";function t(t,e){var n=this;n.albums=null,n.error={message:null,icon:"warning",reset:function(){n.error={message:"",icon:"warning"}}},n.searchText="",n.artistpk=0,n.albumClick=function(t){window.location="#/album/"+t.Id},n.getAlbums=function(){e.getAlbums().success(function(t){n.albums=t}).error(function(){alert("failed to get albums")})},n.addAlbum=function(){e.album=e.newAlbum(),e.updateAlbum(e.album),window.location="#/album/edit/"+e.album.Id},n.deleteAlbum=function(t){confirm("Are you sure you want to delete this album?")&&e.deleteAlbum(t).success(function(){n.albums=e.albums}).error(onPageError)},n.albumsFilter=function(t){var e=n.searchText.toLowerCase();return t&&t.Title&&(t.Title.toLowerCase().indexOf(e)>-1||t.Artist.ArtistName.toLowerCase().indexOf(e)>-1)?!0:!1},t.$root.$on("onsearchkey",function(t,e){n.searchText=e}),n.getAlbums()}angular.module("app").controller("albumsController",t),t.$inject=["$scope","albumService"]}(),function(){"use strict";function t(t,e,n,a,r){var u=this;u.artist=null,u.albums=[],u.error={message:null,icon:"warning",reset:function(){u.error={message:"",icon:"warning"}},show:function(t,e){u.error.message=t,u.error.icon=e?e:"warning"}},u.getArtist=function(e){t.get("../api/artist?id="+e).success(function(t){u.artist=t.Artist,u.albums=t.Albums}).error(function(){u.error.show("Artist couldn't be loaded.","warning")})},u.saveArtist=function(e){t.post("../api/artist/",e).success(function(t){u.artist=t.Artist,u.albums=t.Albums,$("#EditModal").modal("hide")}).error(function(){u.error.show("Artist couldn't be saved.","warning")})},u.albumClick=function(t){e.location.hash="/album/"+t.Id},u.addAlbum=function(){r.album=r.newAlbum(),r.album.ArtistId=u.artist.Id,r.album.Artist.Id=u.artist.Id,r.album.Artist.ArtistName=u.artist.ArtistName,r.updateAlbum(r.album),e.location.hash="/album/edit/-1"},u.getArtist(n.artistId),a.addClass("#MainView","slide-animation")}angular.module("app").controller("artistController",t),t.$inject=["$http","$window","$routeParams","$animate","albumService"]}();
//# sourceMappingURL=app.min.js.map